const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DMU6q_dg.js","assets/vendor-react-BxsGb6Ph.js","assets/vendor-DxpCibxB.js","assets/vendor-ui-l_DttnRj.js","assets/vendor-ui-DpEM1HT6.css","assets/index-BsrMOmjk.css","assets/index-rvNyQCtd.js","assets/useAdmin-z50-k5nw.js","assets/ExportModal-Blvb0ozQ.js","assets/ExportModal-BoB3JpqO.css","assets/index-BzPMJFRS.css","assets/AdminPage-DuSMc_B-.js","assets/AdminPage-VgSjQ50W.css","assets/index-BdknlRMP.js","assets/index-tDgjKyWF.css"])))=>i.map(i=>d[i]);
import{r as a,j as e,L as zt,u as Ot,c as $t,R as Bt,b as Ut}from"./vendor-react-BxsGb6Ph.js";import{N as ln,G as Wt,U as Fn,S as Ht,A as Vt,z as U,n as w,M as Gt,Q as qt,a as Yt,b as Zt,L as Kt,B as cn,D as dn,C as Jt,c as Qt,O as D,f as J,d as Ln,e as Xt,_ as rn,R as te,l as ea,t as na}from"./vendor-ui-l_DttnRj.js";import{u as ta,a as un,O as aa,k as sa}from"./vendor-DxpCibxB.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))p(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const _ of d.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&p(_)}).observe(document,{childList:!0,subtree:!0});function o(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function p(c){if(c.ep)return;c.ep=!0;const d=o(c);fetch(c.href,d)}})();const ia="modulepreload",oa=function(i){return"/static/"+i},Tn={},B=function(s,o,p){let c=Promise.resolve();if(o&&o.length>0){let S=function(x){return Promise.all(x.map(l=>Promise.resolve(l).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const _=document.querySelector("meta[property=csp-nonce]"),C=_?.nonce||_?.getAttribute("nonce");c=S(o.map(x=>{if(x=oa(x),x in Tn)return;Tn[x]=!0;const l=x.endsWith(".css"),b=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${b}`))return;const M=document.createElement("link");if(M.rel=l?"stylesheet":ia,l||(M.as="script"),M.crossOrigin="",M.href=x,C&&M.setAttribute("nonce",C),document.head.appendChild(M),l)return new Promise((P,j)=>{M.addEventListener("load",P),M.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${x}`)))})}))}function d(_){const C=new Event("vite:preloadError",{cancelable:!0});if(C.payload=_,window.dispatchEvent(C),!C.defaultPrevented)throw _}return c.then(_=>{for(const C of _||[])C.status==="rejected"&&d(C.reason);return s().catch(d)})},ra="_dropdownContainer_1six7_3",la="_dropdownMenu_1six7_15",ca="_dropdownContent_1six7_43",on={dropdownContainer:ra,dropdownMenu:la,dropdownContent:ca},da=[{to:"/upload",label:"Upload",Icon:Fn},{to:"/explore",label:"Explore",Icon:Ht},{to:"/analytics",label:"Analytics",Icon:Vt}];function ua(){const i=ta(),s=un(),[o,p]=a.useState(!1),c=a.useRef(null);return a.useEffect(()=>{const d=_=>{c.current&&!c.current.contains(_.target)&&p(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]),e.jsx("nav",{className:"border-b border-gray-200 bg-white shadow-sm sticky top-0 z-50 backdrop-blur-sm bg-white/95",children:e.jsxs(ln,{className:"border-b-2 border-ifrcRed",contentClassName:"grid grid-cols-3 items-center py-6",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0 cursor-pointer group transition-all duration-200 hover:scale-105",onClick:()=>{if(!(i.pathname==="/upload"||i.pathname==="/")){if(i.pathname==="/upload"){if(window.confirmNavigationIfNeeded){window.confirmNavigationIfNeeded("/");return}if(!confirm("You have unsaved changes. Are you sure you want to leave?"))return}s("/")}},children:[e.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-ifrcRed/10 to-ifrcRed/20 group-hover:from-ifrcRed/20 group-hover:to-ifrcRed/30 transition-all duration-200",children:e.jsx(Wt,{className:"h-8 w-8 flex-shrink-0 text-ifrcRed"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"font-bold text-xl text-gray-900 leading-tight",children:"PromptAid Vision"})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("nav",{className:"flex items-center space-x-4 bg-gray-50/80 rounded-xl p-2 backdrop-blur-sm",children:da.map(({to:d,label:_,Icon:C})=>{const S=i.pathname===d||d==="/upload"&&i.pathname==="/"||d==="/explore"&&i.pathname.startsWith("/map/"),x=i.pathname==="/upload"||i.pathname==="/",l=d==="/upload"||d==="/";return e.jsxs("div",{className:"relative",children:[e.jsx(U,{withInternalPadding:!0,className:"p-2",children:e.jsxs(w,{name:_.toLowerCase(),variant:S?"primary":"tertiary",size:1,className:`transition-all duration-200 ${S?"shadow-lg shadow-ifrcRed/20 transform scale-105":"hover:bg-white hover:shadow-md hover:scale-105"}`,onClick:()=>{if(!(x&&l)){if(i.pathname==="/upload"){if(window.confirmNavigationIfNeeded){window.confirmNavigationIfNeeded(d);return}if(!confirm("You have unsaved changes. Are you sure you want to leave?"))return}s(d)}},children:[e.jsx(C,{className:`w-4 h-4 transition-transform duration-200 ${S?"scale-110":"group-hover:scale-110"}`}),e.jsx("span",{className:"inline ml-2 font-semibold",children:_})]})}),S&&e.jsx("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-8 h-1 bg-ifrcRed rounded-full animate-pulse"})]},d)})})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:on.dropdownContainer,ref:c,children:[e.jsx(U,{withInternalPadding:!0,className:"p-2",children:e.jsx(w,{name:"more-options",variant:o?"primary":"tertiary",size:1,className:"transition-all duration-200",onClick:()=>p(!o),children:e.jsx(Gt,{className:"w-4 h-4"})})}),o&&e.jsx("div",{className:on.dropdownMenu,children:e.jsxs("div",{className:on.dropdownContent,children:[e.jsx(U,{withInternalPadding:!0,className:"p-2",children:e.jsxs(w,{name:"help-support",variant:"tertiary",size:1,className:"w-full justify-start",onClick:()=>{if(p(!1),i.pathname==="/upload"){if(window.confirmNavigationIfNeeded){window.confirmNavigationIfNeeded("/help");return}if(!confirm("You have unsaved changes. Are you sure you want to leave?"))return}s("/help")},children:[e.jsx(qt,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-2 font-semibold",children:"Help & Support"})]})}),e.jsx(U,{withInternalPadding:!0,className:"p-2",children:e.jsxs(w,{name:"dev",variant:"tertiary",size:1,className:"w-full justify-start",onClick:()=>{if(p(!1),i.pathname==="/upload"){if(window.confirmNavigationIfNeeded){window.confirmNavigationIfNeeded("/admin");return}if(!confirm("You have unsaved changes. Are you sure you want to leave?"))return}s("/admin")},children:[e.jsx(Yt,{className:"w-4 h-4"}),e.jsx("span",{className:"ml-2 font-semibold",children:"Dev"})]})})]})})]})})]})})}function ga(){return e.jsxs(e.Fragment,{children:[e.jsx(ua,{}),e.jsx(aa,{})]})}const pa="_uploadContainer_1w5i1_1",ma="_dropZone_1w5i1_9",ha="_hasFile_1w5i1_30",fa="_dropZoneIcon_1w5i1_37",xa="_dropZoneText_1w5i1_43",va="_dropZoneSubtext_1w5i1_49",_a="_filePreview_1w5i1_55",ja="_filePreviewImage_1w5i1_64",wa="_fileName_1w5i1_110",Ca="_fileInfo_1w5i1_118",ya="_helpLink_1w5i1_125",Sa="_loadingContainer_1w5i1_145",ba="_loadingText_1w5i1_153",Na="_generateButtonContainer_1w5i1_157",ka="_uploadedMapContainer_1w5i1_165",Ia="_uploadedMapImage_1w5i1_169",Ma="_formGrid_1w5i1_209",La="_titleField_1w5i1_222",Ta="_ratingDescription_1w5i1_230",Da="_ratingSlider_1w5i1_235",Pa="_ratingLabel_1w5i1_242",Ea="_ratingInput_1w5i1_251",Fa="_ratingValue_1w5i1_256",Ra="_submitSection_1w5i1_266",Aa="_successContainer_1w5i1_275",za="_successHeading_1w5i1_280",Oa="_successText_1w5i1_285",$a="_successButton_1w5i1_291",Ba="_viewFullSizeButton_1w5i1_297",Ua="_fullSizeModalOverlay_1w5i1_306",Wa="_lightModalOverlay_1w5i1_320",Ha="_fullSizeModalContent_1w5i1_334",Va="_fullSizeModalHeader_1w5i1_345",Ga="_fullSizeModalImage_1w5i1_361",qa="_confirmSection_1w5i1_398",Ya="_step2Layout_1w5i1_407",Za="_topRow_1w5i1_413",Ka="_ratingHidden_1w5i1_421",Ja="_imageSection_1w5i1_425",Qa="_ratingContent_1w5i1_435",Xa="_mapColumn_1w5i1_453",es="_contentColumn_1w5i1_458",ns="_step2bLayout_1w5i1_465",ts="_metadataSectionCard_1w5i1_562",as="_droneMetadataSection_1w5i1_571",ss="_droneMetadataHeading_1w5i1_577",is="_droneMetadataGrid_1w5i1_585",os="_rtkFixContainer_1w5i1_591",rs="_rtkFixLabel_1w5i1_597",ls="_rtkFixCheckbox_1w5i1_606",cs="_confirmButtonContainer_1w5i1_621",ds="_ratingWarningContent_1w5i1_629",us="_ratingWarningTitle_1w5i1_637",gs="_ratingWarningText_1w5i1_644",ps="_ratingWarningButtons_1w5i1_651",ms="_preprocessingProgress_1w5i1_658",hs="_carouselContainer_1w5i1_711",fs="_carouselImageWrapper_1w5i1_716",xs="_carouselImage_1w5i1_716",vs="_carouselNavigation_1w5i1_739",_s="_carouselButton_1w5i1_751",js="_carouselIndicators_1w5i1_775",ws="_carouselIndicator_1w5i1_775",Cs="_carouselIndicatorActive_1w5i1_804",ys="_viewImageButtonContainer_1w5i1_840",t={uploadContainer:pa,dropZone:ma,hasFile:ha,dropZoneIcon:fa,dropZoneText:xa,dropZoneSubtext:va,filePreview:_a,filePreviewImage:ja,fileName:wa,fileInfo:Ca,helpLink:ya,loadingContainer:Sa,loadingText:ba,generateButtonContainer:Na,uploadedMapContainer:ka,uploadedMapImage:Ia,formGrid:Ma,titleField:La,ratingDescription:Ta,ratingSlider:Da,ratingLabel:Pa,ratingInput:Ea,ratingValue:Fa,submitSection:Ra,successContainer:Aa,successHeading:za,successText:Oa,successButton:$a,viewFullSizeButton:Ba,fullSizeModalOverlay:Ua,lightModalOverlay:Wa,fullSizeModalContent:Ha,fullSizeModalHeader:Va,fullSizeModalImage:Ga,confirmSection:qa,step2Layout:Ya,topRow:Za,ratingHidden:Ka,imageSection:Ja,ratingContent:Qa,mapColumn:Xa,contentColumn:es,step2bLayout:ns,metadataSectionCard:ts,droneMetadataSection:as,droneMetadataHeading:ss,droneMetadataGrid:is,rtkFixContainer:os,rtkFixLabel:rs,rtkFixCheckbox:ls,confirmButtonContainer:cs,ratingWarningContent:ds,ratingWarningTitle:us,ratingWarningText:gs,ratingWarningButtons:ps,preprocessingProgress:ms,carouselContainer:hs,carouselImageWrapper:fs,carouselImage:xs,carouselNavigation:vs,carouselButton:_s,carouselIndicators:js,carouselIndicator:ws,carouselIndicatorActive:Cs,viewImageButtonContainer:ys},Rn=a.createContext(void 0),Ss=({children:i})=>{const[s,o]=a.useState(""),[p,c]=a.useState(""),[d,_]=a.useState(""),[C,S]=a.useState(""),[x,l]=a.useState(""),[b,M]=a.useState(""),[P,j]=a.useState(""),[F,A]=a.useState(!1),L={search:s,srcFilter:p,catFilter:d,regionFilter:C,countryFilter:x,imageTypeFilter:b,uploadTypeFilter:P,showReferenceExamples:F,setSearch:o,setSrcFilter:c,setCatFilter:_,setRegionFilter:S,setCountryFilter:l,setImageTypeFilter:M,setUploadTypeFilter:j,setShowReferenceExamples:A,clearAllFilters:()=>{o(""),c(""),_(""),S(""),l(""),M(""),j(""),A(!1)}};return e.jsx(Rn.Provider,{value:L,children:i})},bs=()=>{const i=a.useContext(Rn);if(i===void 0)throw new Error("useFilterContext must be used within a FilterProvider");return i};function Dn({files:i,file:s,preview:o,imageType:p,onFileChange:c,onRemoveImage:d,onAddImage:_,onImageTypeChange:C,onChangeFile:S}){const x=l=>{l.preventDefault();const b=l.dataTransfer.files?.[0];b&&c(b)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-700 leading-relaxed max-w-2xl mx-auto",children:"This app evaluates how well multimodal AI models analyze and describe crisis maps and drone imagery. Upload an image and the AI will generate a description. Then you can review and rate the result based on your expertise."}),e.jsx("div",{className:t.helpLink,children:e.jsxs(zt,{to:"/help",className:t.helpLink,children:["More ",e.jsx(Zt,{className:"w-3 h-3"})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(U,{withInternalPadding:!0,className:"bg-transparent border-none shadow-none",children:e.jsx(Kt,{name:"image-type",value:p,onChange:l=>C(l),options:[{key:"crisis_map",label:"Crisis Maps"},{key:"drone_image",label:"Drone Imagery"}],keySelector:l=>l.key,labelSelector:l=>l.label})})}),e.jsxs("div",{className:`${t.dropZone} ${s?t.hasFile:""}`,onDragOver:l=>l.preventDefault(),onDrop:x,children:[i.length>1?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4",children:i.map((l,b)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(l),alt:`Image ${b+1}`,className:"w-full h-32 object-cover rounded"}),e.jsx(cn,{name:"remove-image",variant:"tertiary",onClick:()=>d(b),title:"Remove image",ariaLabel:"Remove image",className:"absolute top-2 right-2 bg-white/90 hover:bg-white shadow-md hover:shadow-lg border border-gray-200 hover:border-red-300 transition-all duration-200 backdrop-blur-sm",children:e.jsx(dn,{className:"w-4 h-4"})}),e.jsx("div",{className:"text-xs text-center mt-1",children:l.name})]},b))}):s&&o?e.jsxs("div",{className:t.filePreview,children:[e.jsx("div",{className:t.filePreviewImage,children:e.jsx("img",{src:o,alt:"File preview"})}),e.jsx("p",{className:t.fileName,children:s.name}),e.jsxs("p",{className:t.fileInfo,children:[(s.size/1024/1024).toFixed(2)," MB"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Fn,{className:t.dropZoneIcon}),e.jsx("p",{className:t.dropZoneText,children:"Drag & Drop any file here"}),e.jsx("p",{className:t.dropZoneSubtext,children:"or"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"inline-block cursor-pointer",children:[e.jsx("input",{type:"file",className:"sr-only",accept:".jpg,.jpeg,.png,.tiff,.tif,.heic,.heif,.webp,.gif,.pdf",onChange:l=>{s&&S?S(l.target.files?.[0]):c(l.target.files?.[0])}}),e.jsx(w,{name:"upload",variant:"secondary",size:1,onClick:()=>document.querySelector('input[type="file"]')?.click(),children:s?"Change Image":"Browse Files"})]}),s&&i.length<5&&e.jsx(w,{name:"add-image",variant:"secondary",size:1,onClick:_,children:"Add Image"})]})]})]})}function Pn({files:i,imageUrl:s,preview:o,onViewFullSize:p,currentImageIndex:c=0,onGoToPrevious:d,onGoToNext:_,onGoToImage:C,showCarousel:S=!1}){return S&&i.length>1?e.jsx(U,{heading:"Uploaded Images",headingLevel:3,withHeaderBorder:!0,withInternalPadding:!0,children:e.jsxs("div",{className:t.carouselContainer,children:[e.jsx("div",{className:t.carouselImageWrapper,children:i[c]?e.jsx("img",{src:URL.createObjectURL(i[c]),alt:`Image ${c+1}`,className:t.carouselImage}):e.jsx("div",{className:t.imagePlaceholder,children:"No image available"})}),e.jsxs("div",{className:t.carouselNavigation,children:[e.jsx(w,{name:"previous-image",variant:"tertiary",size:1,onClick:d,className:t.carouselButton,children:e.jsx(Jt,{className:"w-4 h-4"})}),e.jsx("div",{className:t.carouselIndicators,children:i.map((x,l)=>e.jsx("button",{onClick:()=>C?.(l),className:`${t.carouselIndicator} ${l===c?t.carouselIndicatorActive:""}`,children:l+1},l))}),e.jsx(w,{name:"next-image",variant:"tertiary",size:1,onClick:_,className:t.carouselButton,children:e.jsx(Qt,{className:"w-4 h-4"})})]}),e.jsx("div",{className:t.viewImageButtonContainer,children:e.jsx(w,{name:"view-full-size-carousel",variant:"secondary",size:1,onClick:()=>p({file:i[c],index:c}),disabled:!i[c],children:"View Image"})})]})}):i.length>1?e.jsx("div",{className:"space-y-6",children:i.map((x,l)=>e.jsx(U,{heading:`Image ${l+1}: ${x.name}`,headingLevel:3,withHeaderBorder:!0,withInternalPadding:!0,children:e.jsxs("div",{className:t.uploadedMapContainer,children:[e.jsx("div",{className:t.uploadedMapImage,children:e.jsx("img",{src:URL.createObjectURL(x),alt:`Image ${l+1}`})}),e.jsx("div",{className:t.viewFullSizeButton,children:e.jsx(w,{name:`view-full-size-${l}`,variant:"secondary",size:1,onClick:()=>p({file:x,index:l}),children:"View Image"})})]})},l))}):e.jsx(U,{heading:"Uploaded Image",headingLevel:3,withHeaderBorder:!0,withInternalPadding:!0,children:e.jsxs("div",{className:t.uploadedMapContainer,children:[e.jsx("div",{className:t.uploadedMapImage,children:e.jsx("img",{src:s||o||void 0,alt:"Uploaded image preview"})}),e.jsx("div",{className:t.viewFullSizeButton,children:e.jsx(w,{name:"view-full-size",variant:"secondary",size:1,onClick:()=>p(),children:"View Image"})})]})})}function Ns({files:i,imageType:s,title:o,source:p,eventType:c,epsg:d,countries:_,centerLon:C,centerLat:S,amslM:x,aglM:l,headingDeg:b,yawDeg:M,pitchDeg:P,rollDeg:j,rtkFix:F,stdHM:A,stdVM:z,metadataArray:L,sources:G,types:q,spatialReferences:Y,imageTypes:R,countriesOptions:Q,onTitleChange:Z,onSourceChange:ae,onEventTypeChange:K,onEpsgChange:se,onCountriesChange:ie,onCenterLonChange:oe,onCenterLatChange:re,onAmslMChange:le,onAglMChange:ce,onHeadingDegChange:de,onYawDegChange:ue,onPitchDegChange:ge,onRollDegChange:pe,onRtkFixChange:me,onStdHMChange:he,onStdVMChange:fe,onImageTypeChange:xe,updateMetadataForImage:E}){return i.length>1?e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(D,{label:"Shared Title",name:"title",value:o,onChange:Z,placeholder:"Enter a title for all images...",required:!0})}),i.map((N,m)=>e.jsx("div",{className:"mb-6",children:e.jsx(U,{heading:`Image ${m+1}: ${N.name}`,headingLevel:4,withHeaderBorder:!0,withInternalPadding:!0,children:e.jsxs("div",{className:t.formGrid,children:[s!=="drone_image"&&e.jsx(J,{label:"Source",name:`source_${m}`,value:L[m]?.source||"",onChange:h=>E(m,"source",h),options:G,keySelector:h=>h.s_code,labelSelector:h=>h.label,required:!0}),e.jsx(J,{label:"Event Type",name:`event_type_${m}`,value:L[m]?.eventType||"",onChange:h=>E(m,"eventType",h),options:q,keySelector:h=>h.t_code,labelSelector:h=>h.label,required:s!=="drone_image"}),e.jsx(J,{label:"EPSG",name:`epsg_${m}`,value:L[m]?.epsg||"",onChange:h=>E(m,"epsg",h),options:Y,keySelector:h=>h.epsg,labelSelector:h=>`${h.srid} (EPSG:${h.epsg})`,placeholder:"EPSG",required:s!=="drone_image"}),e.jsx(Ln,{label:"Countries (optional)",name:`countries_${m}`,value:L[m]?.countries||[],onChange:h=>E(m,"countries",h),options:Q,keySelector:h=>h.c_code,labelSelector:h=>h.label,placeholder:"Select one or more"}),s==="drone_image"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:t.droneMetadataSection,children:[e.jsx("h4",{className:t.droneMetadataHeading,children:"Drone Flight Data"}),e.jsxs("div",{className:t.droneMetadataGrid,children:[e.jsx(D,{label:"Center Longitude",name:`center_lon_${m}`,value:L[m]?.centerLon||"",onChange:h=>E(m,"centerLon",h),placeholder:"e.g., -122.4194",step:"any"}),e.jsx(D,{label:"Center Latitude",name:`center_lat_${m}`,value:L[m]?.centerLat||"",onChange:h=>E(m,"centerLat",h),placeholder:"e.g., 37.7749",step:"any"}),e.jsx(D,{label:"Altitude AMSL (m)",name:`amsl_m_${m}`,value:L[m]?.amslM||"",onChange:h=>E(m,"amslM",h),placeholder:"e.g., 100.5",step:"any"}),e.jsx(D,{label:"Altitude AGL (m)",name:`agl_m_${m}`,value:L[m]?.aglM||"",onChange:h=>E(m,"aglM",h),placeholder:"e.g., 50.2",step:"any"}),e.jsx(D,{label:"Heading (degrees)",name:`heading_deg_${m}`,value:L[m]?.headingDeg||"",onChange:h=>E(m,"headingDeg",h),placeholder:"e.g., 180.0",step:"any"}),e.jsx(D,{label:"Yaw (degrees)",name:`yaw_deg_${m}`,value:L[m]?.yawDeg||"",onChange:h=>E(m,"yawDeg",h),placeholder:"e.g., 90.0",step:"any"}),e.jsx(D,{label:"Pitch (degrees)",name:`pitch_deg_${m}`,value:L[m]?.pitchDeg||"",onChange:h=>E(m,"pitchDeg",h),placeholder:"e.g., 0.0",step:"any"}),e.jsx(D,{label:"Roll (degrees)",name:`roll_deg_${m}`,value:L[m]?.rollDeg||"",onChange:h=>E(m,"rollDeg",h),placeholder:"e.g., 0.0",step:"any"}),e.jsx("div",{className:t.rtkFixContainer,children:e.jsxs("label",{className:t.rtkFixLabel,children:[e.jsx("input",{type:"checkbox",checked:L[m]?.rtkFix||!1,onChange:h=>E(m,"rtkFix",h.target.checked),className:t.rtkFixCheckbox}),"RTK Fix Available"]})}),e.jsx(D,{label:"Horizontal Std Dev (m)",name:`std_h_m_${m}`,value:L[m]?.stdHM||"",onChange:h=>E(m,"stdHM",h),placeholder:"e.g., 0.1",step:"any"}),e.jsx(D,{label:"Vertical Std Dev (m)",name:`std_v_m_${m}`,value:L[m]?.stdVM||"",onChange:h=>E(m,"stdVM",h),placeholder:"e.g., 0.2",step:"any"})]})]})})]})})},m))]}):e.jsxs("div",{className:t.formGrid,children:[e.jsx("div",{className:t.titleField,children:e.jsx(D,{label:"Title",name:"title",value:o,onChange:Z,placeholder:"Enter a title for this map...",required:!0})}),s!=="drone_image"&&e.jsx(J,{label:"Source",name:"source",value:p,onChange:ae,options:G,keySelector:N=>N.s_code,labelSelector:N=>N.label,required:!0}),e.jsx(J,{label:"Event Type",name:"event_type",value:c,onChange:K,options:q,keySelector:N=>N.t_code,labelSelector:N=>N.label,required:s!=="drone_image"}),e.jsx(J,{label:"EPSG",name:"epsg",value:d,onChange:se,options:Y,keySelector:N=>N.epsg,labelSelector:N=>`${N.srid} (EPSG:${N.epsg})`,placeholder:"EPSG",required:s!=="drone_image"}),e.jsx(J,{label:"Image Type",name:"image_type",value:s,onChange:xe,options:R,keySelector:N=>N.image_type,labelSelector:N=>N.label,required:!0}),e.jsx(Ln,{label:"Countries (optional)",name:"countries",value:_,onChange:ie,options:Q,keySelector:N=>N.c_code,labelSelector:N=>N.label,placeholder:"Select one or more"}),s==="drone_image"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:t.droneMetadataSection,children:[e.jsx("h4",{className:t.droneMetadataHeading,children:"Drone Flight Data"}),e.jsxs("div",{className:t.droneMetadataGrid,children:[e.jsx(D,{label:"Center Longitude",name:"center_lon",value:C,onChange:oe,placeholder:"e.g., -122.4194",step:"any"}),e.jsx(D,{label:"Center Latitude",name:"center_lat",value:S,onChange:re,placeholder:"e.g., 37.7749",step:"any"}),e.jsx(D,{label:"Altitude AMSL (m)",name:"amsl_m",value:x,onChange:le,placeholder:"e.g., 100.5",step:"any"}),e.jsx(D,{label:"Altitude AGL (m)",name:"agl_m",value:l,onChange:ce,placeholder:"e.g., 50.2",step:"any"}),e.jsx(D,{label:"Heading (degrees)",name:"heading_deg",value:b,onChange:de,placeholder:"e.g., 180.0",step:"any"}),e.jsx(D,{label:"Yaw (degrees)",name:"yaw_deg",value:M,onChange:ue,placeholder:"e.g., 90.0",step:"any"}),e.jsx(D,{label:"Pitch (degrees)",name:"pitch_deg",value:P,onChange:ge,placeholder:"e.g., 0.0",step:"any"}),e.jsx(D,{label:"Roll (degrees)",name:"roll_deg",value:j,onChange:pe,placeholder:"e.g., 0.0",step:"any"}),e.jsx("div",{className:t.rtkFixContainer,children:e.jsxs("label",{className:t.rtkFixLabel,children:[e.jsx("input",{type:"checkbox",checked:F,onChange:N=>me(N.target.checked),className:t.rtkFixCheckbox}),"RTK Fix Available"]})}),e.jsx(D,{label:"Horizontal Std Dev (m)",name:"std_h_m",value:A,onChange:he,placeholder:"e.g., 0.1",step:"any"}),e.jsx(D,{label:"Vertical Std Dev (m)",name:"std_v_m",value:z,onChange:fe,placeholder:"e.g., 0.2",step:"any"})]})]})})]})}function ks({isPerformanceConfirmed:i,scores:s,onScoreChange:o,onConfirmRatings:p,onEditRatings:c}){return i?null:e.jsx(U,{heading:"AI Performance Rating",headingLevel:3,withHeaderBorder:!0,withInternalPadding:!0,children:e.jsxs("div",{className:t.ratingContent,children:[e.jsx("p",{className:t.ratingDescription,children:"How well did the AI perform on the task?"}),["accuracy","context","usability"].map(d=>e.jsxs("div",{className:t.ratingSlider,children:[e.jsx("label",{className:t.ratingLabel,children:d}),e.jsx("input",{type:"range",min:0,max:100,value:s[d],onChange:_=>o(d,Number(_.target.value)),className:t.ratingInput}),e.jsx("span",{className:t.ratingValue,children:s[d]})]},d)),e.jsx("div",{className:t.confirmButtonContainer,children:e.jsx(w,{name:"confirm-ratings",variant:"secondary",onClick:p,children:"Confirm Ratings"})})]})})}function Is({description:i,analysis:s,recommendedActions:o,onDescriptionChange:p,onAnalysisChange:c,onRecommendedActionsChange:d,onBack:_,onDelete:C,onSubmit:S,onEditRatings:x,isPerformanceConfirmed:l=!1}){const b=M=>{if(M){const P=M.split(`
`),j=P.findIndex(z=>z.startsWith("Description:")),F=P.findIndex(z=>z.startsWith("Analysis:")),A=P.findIndex(z=>z.startsWith("Recommended Actions:"));j!==-1&&F!==-1&&A!==-1&&(p(P.slice(j+1,F).join(`
`).trim()),c(P.slice(F+1,A).join(`
`).trim()),d(P.slice(A+1).join(`
`).trim()))}};return e.jsxs(U,{heading:"Generated Text",headingLevel:3,withHeaderBorder:!0,withInternalPadding:!0,children:[e.jsx("div",{className:"text-left space-y-4",children:e.jsx("div",{children:e.jsx(Xt,{name:"generatedContent",value:`Description:
${i||"AI-generated description will appear here..."}

Analysis:
${s||"AI-generated analysis will appear here..."}

Recommended Actions:
${o||"AI-generated recommended actions will appear here..."}`,onChange:b,rows:12,placeholder:"AI-generated content will appear here..."})})}),e.jsxs("div",{className:t.submitSection,children:[e.jsx(w,{name:"back",variant:"secondary",onClick:_,children:"Back"}),l&&x&&e.jsx(w,{name:"edit-ratings",variant:"secondary",onClick:x,children:"Edit Ratings"}),e.jsx(cn,{name:"delete",variant:"tertiary",onClick:C,title:"Delete",ariaLabel:"Delete uploaded image",children:e.jsx(dn,{})}),e.jsx(w,{name:"submit",onClick:S,children:"Submit"})]})]})}function Ms({isOpen:i,imageUrl:s,preview:o,selectedImageData:p,onClose:c}){if(!i)return null;let d,_;return p?(d=URL.createObjectURL(p.file),_=`Image ${p.index+1}: ${p.file.name}`):(d=s||o||void 0,_="Full size map"),e.jsx("div",{className:t.fullSizeModalOverlay,onClick:c,children:e.jsxs("div",{className:t.fullSizeModalContent,onClick:C=>C.stopPropagation(),children:[e.jsx("div",{className:t.fullSizeModalHeader,children:e.jsx(w,{name:"close-modal",variant:"tertiary",size:1,onClick:c,children:"✕"})}),e.jsx("div",{className:t.fullSizeModalImage,children:e.jsx("img",{src:d,alt:_})})]})})}function Ls({isOpen:i,onClose:s}){return i?e.jsx("div",{className:t.fullSizeModalOverlay,onClick:s,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"Please Confirm Your Ratings"}),e.jsx("p",{className:t.ratingWarningText,children:'You must confirm your performance ratings before submitting. Please go back to the rating section and click "Confirm Ratings".'}),e.jsx("div",{className:t.ratingWarningButtons,children:e.jsx(w,{name:"close-warning",variant:"secondary",onClick:s,children:"Close"})})]})})}):null}function Ts({isOpen:i,onConfirm:s,onCancel:o}){return i?e.jsx("div",{className:t.fullSizeModalOverlay,onClick:o,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"Delete Image?"}),e.jsx("p",{className:t.ratingWarningText,children:"This action cannot be undone. Are you sure you want to delete this uploaded image?"}),e.jsxs("div",{className:t.ratingWarningButtons,children:[e.jsx(w,{name:"confirm-delete",variant:"secondary",onClick:s,children:"Delete"}),e.jsx(w,{name:"cancel-delete",variant:"tertiary",onClick:o,children:"Cancel"})]})]})})}):null}function Ds({isOpen:i,onConfirm:s,onCancel:o}){return i?e.jsx("div",{className:t.fullSizeModalOverlay,onClick:o,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"Leave Page?"}),e.jsx("p",{className:t.ratingWarningText,children:"Your uploaded image will be deleted if you leave this page. Are you sure you want to continue?"}),e.jsxs("div",{className:t.ratingWarningButtons,children:[e.jsx(w,{name:"confirm-navigation",variant:"secondary",onClick:s,children:"Leave Page"}),e.jsx(w,{name:"cancel-navigation",variant:"tertiary",onClick:o,children:"Stay"})]})]})})}):null}function Ps({isOpen:i,fallbackInfo:s,onClose:o}){return!i||!s?null:e.jsx("div",{className:t.fullSizeModalOverlay,onClick:o,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"Model Changed"}),e.jsxs("p",{className:t.ratingWarningText,children:[s.originalModel," is currently unavailable. We've automatically switched to ",s.fallbackModel," to complete your request."]}),e.jsx("div",{className:t.ratingWarningButtons,children:e.jsx(w,{name:"close-fallback",variant:"secondary",onClick:o,children:"Got it"})})]})})})}function Es({isOpen:i,preprocessingInfo:s,onClose:o}){return!i||!s?null:e.jsx("div",{className:t.fullSizeModalOverlay,onClick:o,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"File Converted"}),e.jsxs("p",{className:t.ratingWarningText,children:["Your file ",e.jsx("strong",{children:s.original_filename})," has been converted from",e.jsxs("strong",{children:[" ",s.original_mime_type]})," to",e.jsxs("strong",{children:[" ",s.processed_mime_type]})," for optimal processing.",e.jsx("br",{}),e.jsx("br",{}),"This conversion ensures your file is in the best format for our AI models to analyze."]}),e.jsx("div",{className:t.ratingWarningButtons,children:e.jsx(w,{name:"close-preprocessing",variant:"secondary",onClick:o,children:"Got it"})})]})})})}function Fs({isOpen:i,preprocessingFile:s,isPreprocessing:o,preprocessingProgress:p,onConfirm:c,onCancel:d}){return i?e.jsx("div",{className:t.fullSizeModalOverlay,onClick:o?void 0:d,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:_=>_.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"File Conversion Required"}),e.jsx("p",{className:t.ratingWarningText,children:"The file you selected will be converted to PNG format. This ensures optimal compatibility and processing by our AI models."}),!o&&e.jsxs("div",{className:t.ratingWarningButtons,children:[e.jsx(w,{name:"confirm-preprocessing",variant:"secondary",onClick:c,children:"Convert File"}),e.jsx(w,{name:"cancel-preprocessing",variant:"tertiary",onClick:d,children:"Cancel"})]}),o&&e.jsxs("div",{className:t.preprocessingProgress,children:[e.jsx("p",{children:p}),e.jsx(rn,{className:"text-ifrcRed"})]})]})})}):null}function Rs({isOpen:i,unsupportedFile:s,onClose:o}){return!i||!s?null:e.jsx("div",{className:t.fullSizeModalOverlay,onClick:o,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"Unsupported File Format"}),e.jsxs("p",{className:t.ratingWarningText,children:["The file ",e.jsx("strong",{children:s.name})," is not supported for upload.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"Supported formats:"}),e.jsx("br",{}),"• Images: JPEG, PNG, TIFF, HEIC, WebP, GIF",e.jsx("br",{}),"• Documents: PDF (will be converted to image)",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"Recommendation:"})," Convert your file to JPEG or PNG format for best compatibility."]}),e.jsx("div",{className:t.ratingWarningButtons,children:e.jsx(w,{name:"close-unsupported",variant:"secondary",onClick:o,children:"Got it"})})]})})})}function As({isOpen:i,oversizedFile:s,onClose:o,onCancel:p}){return!i||!s?null:e.jsx("div",{className:t.lightModalOverlay,onClick:p,children:e.jsx("div",{className:t.fullSizeModalContent,onClick:c=>c.stopPropagation(),children:e.jsxs("div",{className:t.ratingWarningContent,children:[e.jsx("h3",{className:t.ratingWarningTitle,children:"File Size Warning"}),e.jsxs("p",{className:t.ratingWarningText,children:["The file ",e.jsx("strong",{children:s.name})," is large (",(s.size/(1024*1024)).toFixed(1),"MB).",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"Warning:"})," This file size might exceed the limits of the AI models we use.",e.jsx("br",{}),e.jsx("br",{}),"You can still proceed, but consider using a smaller file if you encounter issues."]}),e.jsxs("div",{className:t.ratingWarningButtons,children:[e.jsx(w,{name:"continue-size-warning",variant:"secondary",onClick:o,children:"Continue"}),e.jsx(w,{name:"cancel-size-warning",variant:"tertiary",onClick:p,children:"Cancel"})]})]})})})}const Ee="selectedVlmModel";function En(){const[i]=Ot(),s=un(),[o,p]=a.useState(1),[c,d]=a.useState(!1),[_,C]=a.useState(!1),S=a.useRef(o),x=a.useRef(null),[l,b]=a.useState(null),[M,P]=a.useState(null),[j,F]=a.useState([]),[A,z]=a.useState(""),[L,G]=a.useState(""),[q,Y]=a.useState(""),[R,Q]=a.useState("crisis_map"),[Z,ae]=a.useState([]),[K,se]=a.useState(""),[ie,oe]=a.useState(""),[re,le]=a.useState(""),[ce,de]=a.useState(""),[ue,ge]=a.useState(""),[pe,me]=a.useState(""),[he,fe]=a.useState(""),[xe,E]=a.useState(""),[N,m]=a.useState(""),[h,Fe]=a.useState(!1),[Re,Ae]=a.useState(""),[ze,Oe]=a.useState(""),[$e,Se]=a.useState([]),[An,zn]=a.useState([]),[On,$n]=a.useState([]),[Bn,Un]=a.useState([]),[Wn,Hn]=a.useState([]),[Vn,Gn]=a.useState([]),[W,be]=a.useState(null),[Be,X]=a.useState([]),[Ne,gn]=a.useState(null),[qn,pn]=a.useState(""),[mn,Ue]=a.useState(""),[hn,We]=a.useState(""),[fn,He]=a.useState(""),[ke,xn]=a.useState({accuracy:50,context:50,usability:50}),[Yn,Ve]=a.useState(!1),[Zn,Ge]=a.useState(null),[ve,Ie]=a.useState(!1),[Kn,vn]=a.useState(!1),[Jn,qe]=a.useState(!1),[Qn,Me]=a.useState(!1),[Ye,Ze]=a.useState(null),[Xn,Ke]=a.useState(!1),[et,_n]=a.useState(null),[nt,Je]=a.useState(!1),[tt,jn]=a.useState(null),[at,ee]=a.useState(!1),[Qe,ne]=a.useState(null),[st,_e]=a.useState(!1),[it,H]=a.useState(""),[ot,Le]=a.useState(!1),[rt,Xe]=a.useState(null),[lt,je]=a.useState(!1),[ct,en]=a.useState(null),[dt,Te]=a.useState(0);S.current=o,x.current=W;const ut=n=>z(n||""),gt=n=>G(n||""),pt=n=>Y(n||""),nn=n=>Q(n||""),mt=n=>ae(Array.isArray(n)?n:[]),ht=n=>oe(n||""),ft=n=>le(n||""),xt=n=>de(n||""),vt=n=>ge(n||""),_t=n=>me(n||""),jt=n=>fe(n||""),wt=n=>E(n||""),Ct=n=>m(n||""),yt=n=>Fe(n||!1),St=n=>Ae(n||""),bt=n=>Oe(n||""),De=n=>p(n),Nt=a.useCallback(()=>{j.length>1&&Te(n=>n>0?n-1:j.length-1)},[j.length]),kt=a.useCallback(()=>{j.length>1&&Te(n=>n<j.length-1?n+1:0)},[j.length]),It=a.useCallback(n=>{n>=0&&n<j.length&&Te(n)},[j.length]),wn=()=>{if(j.length<5){const n=document.createElement("input");n.type="file",n.accept=".jpg,.jpeg,.png,.tiff,.tif,.heic,.heif,.webp,.gif,.pdf",n.onchange=f=>{const u=f.target;if(u.files&&u.files[0]){const g=u.files[0];tn(g)}},n.click()}},Cn=n=>{F(f=>{const u=f.filter((g,r)=>r!==n);return u.length===1?P(u[0]):u.length===0&&P(null),u}),Se(f=>f.filter((u,g)=>g!==n))},Mt=(n,f,u)=>{Se(g=>{const r=[...g];return r[n]||(r[n]={source:"",eventType:"",epsg:"",countries:[],centerLon:"",centerLat:"",amslM:"",aglM:"",headingDeg:"",yawDeg:"",pitchDeg:"",rollDeg:"",rtkFix:!1,stdHM:"",stdVM:""}),r[n]={...r[n],[f]:u},r})},yn=n=>{const f=["image/jpeg","image/jpg","image/png"],u=[".jpg",".jpeg",".png"];let g=!f.includes(n.type);if(!g&&n.name){const r=n.name.toLowerCase().substring(n.name.lastIndexOf("."));g=!u.includes(r)}return g},Sn=n=>{const f=["text/html","text/css","application/javascript","application/json","text/plain","application/xml","text/xml","application/zip","application/x-zip-compressed","application/x-rar-compressed","application/x-7z-compressed","audio/","video/","text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"];for(const u of f)if(n.type.startsWith(u))return!0;if(n.name){const u=n.name.toLowerCase().substring(n.name.lastIndexOf("."));if([".html",".htm",".css",".js",".json",".txt",".xml",".zip",".rar",".7z",".csv",".xlsx",".xls",".pptx",".ppt",".docx",".doc",".mp3",".mp4",".avi",".mov"].includes(u))return!0}return!1},tn=n=>{if(n){if(console.log("File selected:",n.name,"Type:",n.type,"Size:",n.size),n.size/(1024*1024)>5&&(console.log("File too large, showing size warning modal"),en(n),je(!0)),Sn(n)){console.log("File format not supported at all, showing unsupported format modal"),Xe(n),Le(!0);return}yn(n)?(console.log("File needs preprocessing, showing modal"),ne(n),ee(!0)):(console.log("File does not need preprocessing, setting directly"),j.length===0?(P(n),F([n])):F(u=>[...u,n]))}},bn=n=>{if(n){if(console.log("File changed:",n.name,"Type:",n.type,"Size:",n.size),n.size/(1024*1024)>5&&(console.log("File too large, showing size warning modal"),en(n),je(!0)),Sn(n)){console.log("File format not supported at all, showing unsupported format modal"),Xe(n),Le(!0);return}yn(n)?(console.log("File needs preprocessing, showing modal"),ne(n),ee(!0)):(console.log("File does not need preprocessing, replacing last file"),j.length>1?(F(u=>{const g=[...u];return g[g.length-1]=n,g}),j.length===1&&P(n)):(P(n),F([n])))}};async function we(n){const f=await n.text();try{return f?JSON.parse(f):{}}catch{return{error:f}}}function an(n,f){const u=n instanceof Error?n.message:`Failed to ${f.toLowerCase()}`;alert(u)}async function Nn(){if(j.length!==0){d(!0);try{j.length===1?await Lt():await Tt()}catch(n){an(n,"Upload")}finally{d(!1)}}}async function Lt(){console.log("DEBUG: Starting single image upload");const n=new FormData;n.append("file",j[0]),n.append("title",K),n.append("image_type",R),A&&n.append("source",A),L&&n.append("event_type",L),q&&n.append("epsg",q),Z.length>0&&Z.forEach(r=>n.append("countries",r)),R==="drone_image"&&(ie&&n.append("center_lon",ie),re&&n.append("center_lat",re),ce&&n.append("amsl_m",ce),ue&&n.append("agl_m",ue),pe&&n.append("heading_deg",pe),he&&n.append("yaw_deg",he),xe&&n.append("pitch_deg",xe),N&&n.append("roll_deg",N),h&&n.append("rtk_fix",h.toString()),Re&&n.append("std_h_m",Re),ze&&n.append("std_v_m",ze));const f=localStorage.getItem(Ee);f&&n.append("model_name",f);const u=await fetch("/api/images/",{method:"POST",body:n}),g=await we(u);if(!u.ok)throw new Error(g.error||"Upload failed");console.log("DEBUG: Single upload response:",g),await kn(g,!1)}async function Tt(){console.log("DEBUG: Starting multi-image upload");const n=new FormData;j.forEach(r=>n.append("files",r)),n.append("title",K),n.append("image_type",R),$e.forEach((r,v)=>{r.source&&n.append(`source_${v}`,r.source),r.eventType&&n.append(`event_type_${v}`,r.eventType),r.epsg&&n.append(`epsg_${v}`,r.epsg),r.countries.length>0&&r.countries.forEach(T=>n.append(`countries_${v}`,T)),R==="drone_image"&&(r.centerLon&&n.append(`center_lon_${v}`,r.centerLon),r.centerLat&&n.append(`center_lat_${v}`,r.centerLat),r.amslM&&n.append(`amsl_m_${v}`,r.amslM),r.aglM&&n.append(`agl_m_${v}`,r.aglM),r.headingDeg&&n.append(`heading_deg_${v}`,r.headingDeg),r.yawDeg&&n.append(`yaw_deg_${v}`,r.yawDeg),r.pitchDeg&&n.append(`pitch_deg_${v}`,r.pitchDeg),r.rollDeg&&n.append(`roll_deg_${v}`,r.rollDeg),r.rtkFix&&n.append(`rtk_fix_${v}`,r.rtkFix.toString()),r.stdHM&&n.append(`std_h_m_${v}`,r.stdHM),r.stdVM&&n.append(`std_v_m_${v}`,r.stdVM))});const f=localStorage.getItem(Ee);f&&n.append("model_name",f);const u=await fetch("/api/images/multi",{method:"POST",body:n}),g=await we(u);if(!u.ok)throw new Error(g.error||"Upload failed");console.log("DEBUG: Multi upload response:",g),await kn(g,!0)}async function kn(n,f){gn(n.image_url),n.preprocessing_info&&typeof n.preprocessing_info=="object"&&"was_preprocessed"in n.preprocessing_info&&n.preprocessing_info.was_preprocessed===!0&&(jn(n.preprocessing_info),Je(!0));const u=n.image_id;if(!u)throw new Error("Upload failed: image_id not found");if(be(u),f)if(n.image_ids&&Array.isArray(n.image_ids)){const y=n.image_ids;console.log("DEBUG: Storing image IDs for multi-upload:",y),X(y)}else console.log("DEBUG: Multi-upload but no image_ids found, using single ID"),X([u]);else console.log("DEBUG: Storing single image ID:",u),X([u]);const g=n,r=g.raw_json?.fallback_info;r&&(_n({originalModel:r.original_model,fallbackModel:r.fallback_model,reason:r.reason}),Ke(!0));const v=g.raw_json?.metadata;if(v){const y=v.metadata||v;if(y&&typeof y=="object"){const O=[];if(f){const k=y.metadata_images;if(k&&typeof k=="object")for(let $=1;$<=j.length;$++){const Ce=`image${$}`,sn=k[Ce];if(sn&&typeof sn=="object"){const ye=sn;O.push({source:ye.source||"",eventType:ye.type||"",epsg:ye.epsg||"",countries:Array.isArray(ye.countries)?ye.countries:[],centerLon:"",centerLat:"",amslM:"",aglM:"",headingDeg:"",yawDeg:"",pitchDeg:"",rollDeg:"",rtkFix:!1,stdHM:"",stdVM:""})}else O.push({source:"",eventType:"",epsg:"",countries:[],centerLon:"",centerLat:"",amslM:"",aglM:"",headingDeg:"",yawDeg:"",pitchDeg:"",rollDeg:"",rtkFix:!1,stdHM:"",stdVM:""})}else{const $={source:y.source||"",eventType:y.type||"",epsg:y.epsg||"",countries:Array.isArray(y.countries)?y.countries:[],centerLon:"",centerLat:"",amslM:"",aglM:"",headingDeg:"",yawDeg:"",pitchDeg:"",rollDeg:"",rtkFix:!1,stdHM:"",stdVM:""};for(let Ce=0;Ce<j.length;Ce++)O.push({...$})}}else{const k={source:y.source||"",eventType:y.type||"",epsg:y.epsg||"",countries:Array.isArray(y.countries)?y.countries:[],centerLon:"",centerLat:"",amslM:"",aglM:"",headingDeg:"",yawDeg:"",pitchDeg:"",rollDeg:"",rtkFix:!1,stdHM:"",stdVM:""};O.push(k)}if(Se(O),O.length>0){const k=O[0];if(y&&typeof y=="object"){const $=y.title;$&&se($||"")}z(k.source||""),G(k.eventType||""),Y(k.epsg||""),ae(k.countries||[]),R==="drone_image"&&(oe(k.centerLon||""),le(k.centerLat||""),de(k.amslM||""),ge(k.aglM||""),me(k.headingDeg||""),fe(k.yawDeg||""),E(k.pitchDeg||""),m(k.rollDeg||""),Fe(k.rtkFix||!1),Ae(k.stdHM||""),Oe(k.stdVM||""))}}}const T=g.raw_json?.metadata;T&&(T.description&&Ue(T.description),T.analysis&&We(T.analysis),T.recommended_actions&&He(T.recommended_actions)),g.generated&&pn(g.generated),De("2a")}async function Dt(){if(console.log("handleSubmit called with:",{uploadedImageId:W,title:K,draft:qn}),!W)return alert("No image to submit");if(!ve){vn(!0);return}try{const n=Be.length>0?Be:[W];console.log("DEBUG: Submit - Using image IDs:",n),console.log("DEBUG: Submit - uploadedImageIds:",Be),console.log("DEBUG: Submit - uploadedImageId:",W);for(let v=0;v<n.length;v++){const T=n[v],y=$e[v]||{source:A||"OTHER",eventType:L||"OTHER",epsg:q||"OTHER",countries:Z||[]},O={source:R==="drone_image"?void 0:y.source||"OTHER",event_type:y.eventType||"OTHER",epsg:y.epsg||"OTHER",image_type:R,countries:y.countries||[]};console.log(`Updating metadata for image ${v+1}:`,O);const k=await fetch(`/api/images/${T}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)}),$=await we(k);if(!k.ok)throw new Error($.error||`Metadata update failed for image ${v+1}`)}const f=`Description: ${mn}

Analysis: ${hn}

Recommended Actions: ${fn}`,u={title:K,edited:f,accuracy:ke.accuracy,context:ke.context,usability:ke.usability};console.log("Updating caption:",u);const g=await fetch(`/api/images/${W}/caption`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),r=await we(g);if(!g.ok)throw new Error(r.error||"Caption update failed");be(null),X([]),De(3)}catch(n){an(n,"Submit")}}async function In(){if(console.log("handleDelete called with uploadedImageId:",W),!W){alert("No image to delete. Please try refreshing the page.");return}qe(!0)}async function Pt(){try{console.log("Deleting image with ID:",W);const n=await fetch(`/api/images/${W}`,{method:"DELETE"});if(!n.ok){const f=await we(n);throw new Error(f.error||`Delete failed with status ${n.status}`)}qe(!1),Mn()}catch(n){an(n,"Delete")}}const Mn=()=>{Ie(!1),p(1),P(null),F([]),b(null),be(null),X([]),gn(null),se(""),z(""),G(""),Y(""),ae([]),oe(""),le(""),de(""),ge(""),me(""),fe(""),E(""),m(""),Fe(!1),Ae(""),Oe(""),xn({accuracy:50,context:50,usability:50}),pn(""),Ue(""),We(""),He(""),Se([]),Ke(!1),_n(null),Je(!1),jn(null),ee(!1),ne(null),_e(!1),H(""),Le(!1),Xe(null),je(!1),en(null),s("/upload",{replace:!0})},Pe=a.useCallback(n=>{n==="/upload"||n==="/"||(x.current?(Ze(n),Me(!0)):s(n))},[s]);async function Et(){if(Ye&&x.current)try{await fetch(`/api/images/${x.current}`,{method:"DELETE"}),Me(!1),Ze(null),s(Ye)}catch(n){console.error("Failed to delete image before navigation:",n),Me(!1),Ze(null),s(Ye)}}const Ft=async()=>{if(Qe){_e(!0),H("Starting file conversion...");try{const n=new FormData;n.append("file",Qe),n.append("preprocess_only","true"),H("Converting file format...");const f=await fetch("/api/images/preprocess",{method:"POST",body:n});if(!f.ok)throw new Error("Preprocessing failed");const u=await f.json();H("Finalizing conversion...");const g=atob(u.processed_content),r=new Uint8Array(g.length);for(let y=0;y<g.length;y++)r[y]=g.charCodeAt(y);const v=new File([r],u.processed_filename,{type:u.processed_mime_type}),T=URL.createObjectURL(v);j.length===0?(P(v),F([v])):F(y=>[...y,v]),b(T),H("Conversion complete!"),setTimeout(()=>{ee(!1),ne(null),_e(!1),H("")},1e3)}catch(n){console.error("Preprocessing error:",n),H("Conversion failed. Please try again."),setTimeout(()=>{ee(!1),ne(null),_e(!1),H("")},2e3)}}},Rt=()=>{ee(!1),ne(null),_e(!1),H("")},At=async n=>{C(!0);try{const f=n.map(async v=>{const T=await fetch(`/api/images/${v}`);if(!T.ok)throw new Error(`Failed to fetch image ${v}`);const y=await T.json(),O=await fetch(`/api/images/${v}/file`);if(!O.ok)throw new Error(`Failed to fetch image file ${v}`);const k=await O.blob(),$=y.file_key.split("/").pop()||`contributed_${v}.png`;return{file:new File([k],$,{type:k.type}),imageData:y}}),u=await Promise.all(f),g=u.map(v=>v.file),r=u[0]?.imageData;F(g),X(n),n.length===1&&be(n[0]),g.length>=1&&P(g[0]),r?.image_type&&Q(r.image_type)}catch(f){console.error("Failed to fetch contributed images:",f),alert(`Failed to load contributed images: ${f instanceof Error?f.message:"Unknown error"}`)}finally{C(!1)}};return a.useEffect(()=>{Promise.all([fetch("/api/sources").then(n=>n.json()),fetch("/api/types").then(n=>n.json()),fetch("/api/spatial-references").then(n=>n.json()),fetch("/api/image-types").then(n=>n.json()),fetch("/api/countries").then(n=>n.json()),fetch("/api/models").then(n=>n.json())]).then(([n,f,u,g,r,v])=>{!localStorage.getItem(Ee)&&v?.length&&localStorage.setItem(Ee,v[0].m_code),zn(n),$n(f),Un(u),Hn(g),Gn(r),n.length>0&&z(n[0].s_code),G("OTHER"),Y("OTHER"),g.length>0&&!i.get("imageType")&&!R&&Q(g[0].image_type)})},[i,R]),a.useEffect(()=>(window.confirmNavigationIfNeeded=n=>{Pe(n)},()=>{delete window.confirmNavigationIfNeeded}),[Pe]),a.useEffect(()=>{const n=g=>{if(x.current){const r="You have an uploaded image that will be deleted if you leave this page. Are you sure you want to leave?";return g.preventDefault(),g.returnValue=r,r}},f=()=>{x.current&&fetch(`/api/images/${x.current}`,{method:"DELETE"}).catch(console.error)},u=g=>{const r=g.target,v=r.closest("a[href]")||r.closest("[data-navigate]");if(v&&x.current){const T=v.getAttribute("href")||v.getAttribute("data-navigate");T&&T!=="#"&&!T.startsWith("javascript:")&&!T.startsWith("mailto:")&&(g.preventDefault(),g.stopPropagation(),Pe(T))}};return window.addEventListener("beforeunload",n),document.addEventListener("click",u,!0),()=>{window.removeEventListener("beforeunload",n),document.removeEventListener("click",u,!0),f()}},[Pe]),a.useEffect(()=>{if(!M){b(null);return}const n=URL.createObjectURL(M);return b(n),()=>URL.revokeObjectURL(n)},[M]),a.useEffect(()=>{const n=i.get("contribute"),f=i.get("imageIds");if(n==="true"&&f){const u=f.split(",").filter(g=>g.trim());u.length>0&&At(u)}},[i]),a.useEffect(()=>{o==="2b"&&Te(0)},[o]),e.jsxs(ln,{children:[o!==3&&e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:t.uploadContainer,"data-step":o,children:[o===1&&!i.get("step")&&!_&&e.jsx(Dn,{files:j,file:M,preview:l,imageType:R,onFileChange:tn,onRemoveImage:Cn,onAddImage:wn,onImageTypeChange:nn,onChangeFile:bn}),o===1&&i.get("contribute")==="true"&&!_&&j.length>0&&e.jsx(Dn,{files:j,file:M,preview:l,imageType:R,onFileChange:tn,onRemoveImage:Cn,onAddImage:wn,onImageTypeChange:nn,onChangeFile:bn}),c&&e.jsxs("div",{className:t.loadingContainer,children:[e.jsx(rn,{className:"text-ifrcRed"}),e.jsx("p",{className:t.loadingText,children:"Generating..."})]}),_&&e.jsxs("div",{className:t.loadingContainer,children:[e.jsx(rn,{className:"text-ifrcRed"}),e.jsx("p",{className:t.loadingText,children:"Loading contribution..."})]}),(o===1&&!c&&!_||o===1&&i.get("contribute")==="true"&&!c&&!_&&j.length>0)&&e.jsx("div",{className:t.generateButtonContainer,children:Ne?e.jsx(w,{name:"generate-from-url",onClick:Nn,children:"Generate Caption"}):e.jsx(w,{name:"generate",disabled:j.length===0,onClick:Nn,children:"Generate"})}),o==="2a"&&e.jsxs("div",{className:t.step2Layout,children:[e.jsx("div",{className:t.mapColumn,children:e.jsx(Pn,{files:j,imageUrl:Ne,preview:l,onViewFullSize:n=>{Ge(n||null),Ve(!0)}})}),e.jsx("div",{className:t.contentColumn,children:e.jsxs("div",{className:t.metadataSectionCard,children:[e.jsx(Ns,{files:j,imageType:R,title:K,source:A,eventType:L,epsg:q,countries:Z,centerLon:ie,centerLat:re,amslM:ce,aglM:ue,headingDeg:pe,yawDeg:he,pitchDeg:xe,rollDeg:N,rtkFix:h,stdHM:Re,stdVM:ze,metadataArray:$e,sources:An,types:On,spatialReferences:Bn,imageTypes:Wn,countriesOptions:Vn,onTitleChange:n=>se(n||""),onSourceChange:ut,onEventTypeChange:gt,onEpsgChange:pt,onCountriesChange:mt,onCenterLonChange:ht,onCenterLatChange:ft,onAmslMChange:xt,onAglMChange:vt,onHeadingDegChange:_t,onYawDegChange:jt,onPitchDegChange:wt,onRollDegChange:Ct,onRtkFixChange:yt,onStdHMChange:St,onStdVMChange:bt,onImageTypeChange:nn,updateMetadataForImage:Mt}),e.jsxs("div",{className:t.confirmSection,children:[e.jsx(cn,{name:"delete",variant:"tertiary",onClick:In,title:"Delete",ariaLabel:"Delete uploaded image",children:e.jsx(dn,{})}),e.jsx(w,{name:"confirm-metadata",onClick:()=>De("2b"),children:"Next"})]})]})})]}),o==="2b"&&e.jsxs("div",{className:t.step2bLayout,children:[e.jsxs("div",{className:`${t.topRow} ${ve?t.ratingHidden:""}`,children:[e.jsx("div",{className:t.imageSection,children:e.jsx(Pn,{files:j,imageUrl:Ne,preview:l,onViewFullSize:n=>{Ge(n||null),Ve(!0)},currentImageIndex:dt,onGoToPrevious:Nt,onGoToNext:kt,onGoToImage:It,showCarousel:!0})}),!ve&&e.jsx("div",{className:t.metadataSectionCard,children:e.jsx(ks,{isPerformanceConfirmed:ve,scores:ke,onScoreChange:(n,f)=>xn(u=>({...u,[n]:f})),onConfirmRatings:()=>Ie(!0),onEditRatings:()=>Ie(!1)})})]}),e.jsx("div",{className:t.metadataSectionCard,children:e.jsx(Is,{description:mn,analysis:hn,recommendedActions:fn,onDescriptionChange:n=>Ue(n||""),onAnalysisChange:n=>We(n||""),onRecommendedActionsChange:n=>He(n||""),onBack:()=>De("2a"),onDelete:In,onSubmit:Dt,onEditRatings:()=>Ie(!1),isPerformanceConfirmed:ve})})]})]})}),o===3&&e.jsxs("div",{className:t.successContainer,children:[e.jsx(te,{level:2,className:t.successHeading,children:"Saved!"}),e.jsx("p",{className:t.successText,children:i.get("contribute")==="true"?"Your contribution has been successfully saved.":"Your caption has been successfully saved."}),e.jsx("div",{className:t.successButton,children:e.jsx(w,{name:"upload-another",onClick:()=>{Mn()},children:"Upload Another"})})]}),e.jsx(Ms,{isOpen:Yn,imageUrl:Ne,preview:l,selectedImageData:Zn,onClose:()=>{Ve(!1),Ge(null)}}),e.jsx(Ls,{isOpen:Kn,onClose:()=>vn(!1)}),e.jsx(Ts,{isOpen:Jn,onConfirm:Pt,onCancel:()=>qe(!1)}),e.jsx(Ds,{isOpen:Qn,onConfirm:Et,onCancel:()=>Me(!1)}),e.jsx(Ps,{isOpen:Xn,fallbackInfo:et,onClose:()=>Ke(!1)}),e.jsx(Es,{isOpen:nt,preprocessingInfo:tt,onClose:()=>Je(!1)}),e.jsx(Fs,{isOpen:at,preprocessingFile:Qe,isPreprocessing:st,preprocessingProgress:it,onConfirm:Ft,onCancel:Rt}),e.jsx(Rs,{isOpen:ot,unsupportedFile:rt,onClose:()=>Le(!1)}),e.jsx(As,{isOpen:lt,oversizedFile:ct,onClose:()=>je(!1),onCancel:()=>je(!1)})]})}const zs="_helpContainer_1wavj_1",Os="_helpSection_1wavj_13",$s="_sectionHeader_1wavj_49",Bs="_sectionTitle_1wavj_91",Us="_sectionContent_1wavj_105",Ws="_guidelinesList_1wavj_119",Hs="_buttonContainer_1wavj_181",I={helpContainer:zs,helpSection:Os,sectionHeader:$s,sectionTitle:Bs,sectionContent:Us,guidelinesList:Ws,buttonContainer:Hs};function Vs(){const i=un(),{setShowReferenceExamples:s}=bs(),o=()=>{i("/upload")},p=()=>{s(!0),i("/explore")},c=()=>{i("/analytics?view=crisis_maps")};return e.jsx(ln,{className:"py-10",children:e.jsx("div",{className:I.helpContainer,children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:I.helpSection,children:[e.jsx("div",{className:I.sectionHeader,children:e.jsx(te,{level:3,className:I.sectionTitle,children:"Introduction"})}),e.jsx("div",{className:I.sectionContent,children:"In collaboration with the IFRC, PromptAid Vision is a tool that generates textual descriptions of crisis maps/crisis drone images utiliing Visual language models. This prototype is for collecting data for the fine-tuning of our own models. We aim to utilize AI tools to support national societies with rapid decision making during emergencies."}),e.jsx("div",{className:I.buttonContainer,children:e.jsx(w,{name:"upload-now",variant:"secondary",onClick:o,children:"Upload now →"})})]}),e.jsxs("div",{className:I.helpSection,children:[e.jsx("div",{className:I.sectionHeader,children:e.jsx(te,{level:3,className:I.sectionTitle,children:"Guidelines"})}),e.jsxs("div",{className:I.sectionContent,children:["To make the process smoother, please follow the guidelines below:",e.jsxs("ul",{className:I.guidelinesList,children:[e.jsx("li",{children:"Avoid uploading images that are not crisis maps/crisis drone images."}),e.jsx("li",{children:"Confirm the image details prior to modifying the description."}),e.jsx("li",{children:"Before the modification, please read the description generated and provide a rating via the rating sliders."}),e.jsx("li",{children:'Click the "Submit" button to save the description.'})]})]}),e.jsx("div",{className:I.buttonContainer,children:e.jsx(w,{name:"see-examples",variant:"secondary",onClick:p,children:"See examples →"})})]}),e.jsxs("div",{className:I.helpSection,children:[e.jsx("div",{className:I.sectionHeader,children:e.jsx(te,{level:3,className:I.sectionTitle,children:"VLMs"})}),e.jsx("div",{className:I.sectionContent,children:"PromptAid Vision uses a variety of Visual Language Models (VLMs). A random VLM is selected for each upload. Therefore feel free to delete and reupload. You can view performance details here:"}),e.jsx("div",{className:I.buttonContainer,children:e.jsx(w,{name:"view-vlm-details",variant:"secondary",onClick:c,children:"View VLM details →"})})]}),e.jsxs("div",{className:I.helpSection,children:[e.jsx("div",{className:I.sectionHeader,children:e.jsx(te,{level:3,className:I.sectionTitle,children:"Dataset"})}),e.jsx("div",{className:I.sectionContent,children:"All users are able to export the dataset. You could apply filters when exporting, and it have the option to organize based on model fine-tuning formats."}),e.jsx("div",{className:I.buttonContainer,children:e.jsx(w,{name:"export-dataset",variant:"secondary",onClick:()=>{s(!1),i("/explore"),setTimeout(()=>{const d=document.querySelector('[name="export-dataset"]');d&&d.click()},100)},children:"Export dataset →"})})]}),e.jsxs("div",{className:I.helpSection,children:[e.jsx("div",{className:I.sectionHeader,children:e.jsx(te,{level:3,className:I.sectionTitle,children:"Contact us"})}),e.jsx("div",{className:I.sectionContent,children:"Need help or have questions about PromptAid Vision? Our team is here to support you."}),e.jsx("div",{className:I.buttonContainer,children:e.jsx(w,{name:"contact-support",variant:"secondary",disabled:!0,children:"Get in touch →"})})]})]})})})}const Gs=a.createContext(void 0),qs=({children:i})=>{const[s,o]=a.useState(!1),[p,c]=a.useState(!0),d=async()=>{const x=localStorage.getItem("adminToken");if(!x){o(!1),c(!1);return}try{(await fetch("/api/admin/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`}})).ok?o(!0):(localStorage.removeItem("adminToken"),o(!1))}catch(l){console.error("Error verifying admin token:",l),localStorage.removeItem("adminToken"),o(!1)}finally{c(!1)}},_=async x=>{try{const l=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:x})});if(l.ok){const b=await l.json();return localStorage.setItem("adminToken",b.access_token),o(!0),!0}else return!1}catch(l){return console.error("Login error:",l),!1}},C=()=>{localStorage.removeItem("adminToken"),o(!1)};a.useEffect(()=>{d()},[]);const S={isAuthenticated:s,isLoading:p,login:_,logout:C,verifyToken:d};return e.jsx(Gs.Provider,{value:S,children:i})},Ys=a.lazy(()=>B(()=>import("./index-DMU6q_dg.js"),__vite__mapDeps([0,1,2,3,4,5]))),Zs=a.lazy(()=>B(()=>import("./index-rvNyQCtd.js"),__vite__mapDeps([6,1,2,3,4,7,8,9,10]))),Ks=a.lazy(()=>B(()=>import("./AdminPage-DuSMc_B-.js"),__vite__mapDeps([11,1,2,7,3,4,12]))),Js=a.lazy(()=>B(()=>import("./index-BdknlRMP.js"),__vite__mapDeps([13,1,2,3,4,7,8,9,14]))),V=i=>{const s=i();return s.catch(()=>{}),s},Qs=()=>{"requestIdleCallback"in window?requestIdleCallback(()=>{V(()=>B(()=>import("./index-DMU6q_dg.js"),__vite__mapDeps([0,1,2,3,4,5]))),V(()=>B(()=>import("./index-rvNyQCtd.js"),__vite__mapDeps([6,1,2,3,4,7,8,9,10]))),V(()=>B(()=>import("./AdminPage-DuSMc_B-.js"),__vite__mapDeps([11,1,2,7,3,4,12]))),V(()=>B(()=>import("./index-BdknlRMP.js"),__vite__mapDeps([13,1,2,3,4,7,8,9,14])))}):setTimeout(()=>{V(()=>B(()=>import("./index-DMU6q_dg.js"),__vite__mapDeps([0,1,2,3,4,5]))),V(()=>B(()=>import("./index-rvNyQCtd.js"),__vite__mapDeps([6,1,2,3,4,7,8,9,10]))),V(()=>B(()=>import("./AdminPage-DuSMc_B-.js"),__vite__mapDeps([11,1,2,7,3,4,12]))),V(()=>B(()=>import("./index-BdknlRMP.js"),__vite__mapDeps([13,1,2,3,4,7,8,9,14])))},1e3)},Xs=$t([{element:e.jsx(ga,{}),children:[{path:"/",element:e.jsx(En,{})},{path:"/upload",element:e.jsx(En,{})},{path:"/analytics",element:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading Analytics..."}),children:e.jsx(Ys,{})})},{path:"/explore",element:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading Explore..."}),children:e.jsx(Zs,{})})},{path:"/help",element:e.jsx(Vs,{})},{path:"/admin",element:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading Admin..."}),children:e.jsx(Ks,{})})},{path:"/map/:mapId",element:e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading Map Details..."}),children:e.jsx(Js,{})})}]}],{basename:"/static/"});function ei(){const[i,s]=a.useState([]);a.useEffect(()=>{Qs()},[]);const o=a.useCallback(C=>{s(S=>sa([...S,C],x=>x.name)??S)},[s]),p=a.useCallback(C=>{s(S=>{const x=S.findIndex(b=>b.name===C);if(x===-1)return S;const l=[...S];return l.splice(x,1),l})},[s]),c=a.useCallback((C,S)=>{s(x=>{const l=x.findIndex(M=>M.name===C);if(l===-1)return x;const b=[...x];return b[l]={...b[l],...S},b})},[s]),d=a.useMemo(()=>({alerts:i,addAlert:o,removeAlert:p,updateAlert:c}),[i,o,p,c]),_=a.useMemo(()=>({languageNamespaceStatus:{},setLanguageNamespaceStatus:()=>{},currentLanguage:"en",setCurrentLanguage:()=>{},strings:{},setStrings:()=>{},registerNamespace:()=>{}}),[]);return e.jsx(ea.Provider,{value:d,children:e.jsx(na.Provider,{value:_,children:e.jsx(qs,{children:e.jsx(Ss,{children:e.jsx(Bt,{router:Xs})})})})})}function ni(){return e.jsx(ei,{})}Ut.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(ni,{})}));export{Gs as A,Ms as F,B as _,bs as u};
